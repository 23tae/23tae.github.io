<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Minitalk ② 배경 지식 : 시그널" /><meta property="og:locale" content="en" /><meta name="description" content="시그널이란" /><meta property="og:description" content="시그널이란" /><link rel="canonical" href="https://23tae.github.io/posts/minitalk2/" /><meta property="og:url" content="https://23tae.github.io/posts/minitalk2/" /><meta property="og:site_name" content="Justnote" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-10T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Minitalk ② 배경 지식 : 시그널" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="pwyVnBftLVRWrdN-N6v3WUvcMGKWdWZQe6eilBPgBJc" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-18T21:59:07+09:00","datePublished":"2022-07-10T00:00:00+09:00","description":"시그널이란","headline":"Minitalk ② 배경 지식 : 시그널","mainEntityOfPage":{"@type":"WebPage","@id":"https://23tae.github.io/posts/minitalk2/"},"url":"https://23tae.github.io/posts/minitalk2/"}</script><title>Minitalk ② 배경 지식 : 시그널 | Justnote</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Justnote"><meta name="application-name" content="Justnote"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Justnote</a></div><div class="site-subtitle font-italic">배운 내용을 기록하는 곳</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/23tae" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['taehoonkim.dev','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Minitalk ② 배경 지식 : 시그널</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Minitalk ② 배경 지식 : 시그널</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1657378800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 10, 2022 </em> </span> <span> Updated <em class="" data-ts="1658149147" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 18, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/23tae">Taehoon</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1588 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><h1 id="시그널이란">시그널이란</h1><p>비동기적으로 발생한 이벤트를 처리하기 위한 메커니즘을 제공하기 위한 <strong>소프트웨어 인터럽트</strong></p><ul><li>인터럽트 : 예상하지 못한 이벤트<li>인터럽트 핸들링</ul><p><img data-src="/assets/img/42seoul/minitalk/mini2/interrupt_handling.png" alt="interrupt" data-proofer-ignore></p><h2 id="시그널의-라이프사이클"><span class="mr-2">시그널의 라이프사이클</span><a href="#시그널의-라이프사이클" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>발생<ul><li>프로그램에서 발생한 예외적 사항<li>사용자의 입력<li>프로세스 또는 커널에서 생성/전달</ul><li>보관<ul><li>시그널 전달 전까지, 커널이 보관<li>전달 가능해지면 해당 프로세스에게 전달</ul><li>처리<ul><li>지정된 방법에 따라 시그널 처리<ul><li>시그널을 무시함<li>시그널을 캐치해서 핸들링함<li>디폴트 액션을 함 (정의해 놓지 않은 경우)</ul></ul></ol><h2 id="유닉스-계열에서의-시그널"><span class="mr-2">유닉스 계열에서의 시그널</span><a href="#유닉스-계열에서의-시그널" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="심볼릭-상수"><span class="mr-2">심볼릭 상수</span><a href="#심볼릭-상수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>상수로 정의됨 (ex. SIGHUP : 1, SIGINT : 2, … )</p><ul><li>signal.h 라이브러리에 정의됨<li>man signal에서 확인가능<li>시스템별로 번호가 다를 수 있음</ul><p><img data-src="/assets/img/42seoul/minitalk/mini2/signum.png" alt="signum" data-proofer-ignore><br /> 맥에서는 위와 같이 정의가 되어있음. 과제에서 허용된 시그널인 SIGUSR1, SIGUSR2의 경우 각각 30, 31로 정의되어있음.</p><h1 id="시그널-처리">시그널 처리</h1><h2 id="signal-handler"><span class="mr-2">Signal handler</span><a href="#signal-handler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>특정 시그널을 처리하기 위해 지정된 함수<li>Default handler을 대체할 수 있음 (단, SIGKILL, SIGSTOP은 예외)</ul><h2 id="signal-함수"><span class="mr-2">signal 함수</span><a href="#signal-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>시그널이 들어올 때 처리해줄 핸들러를 <strong>등록</strong>하는 것. 이 자체만으로는 특별한 동작을 하진 않음!</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">sighandler_t</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span>
<span class="n">sighandler_t</span> <span class="nf">signal</span><span class="p">(</span><span class="kt">int</span> <span class="n">signum</span><span class="p">,</span> <span class="n">sighandler_t</span> <span class="n">handler</span><span class="p">);</span>
</pre></table></code></div></div><ul><li>매개변수<ul><li>signum : 처리할 시그널의 번호<li>handler : 시그널 핸들러의 함수포인터</ul><li>반환값<ul><li>기존 핸들러의 함수포인터<li>SIG_ERR : 에러</ul></ul><h2 id="handler-등록"><span class="mr-2">handler 등록</span><a href="#handler-등록" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>예제 코드</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">sigint_handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Caught SIGINT!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">psignal</span><span class="p">(</span><span class="n">signo</span><span class="p">,</span> <span class="s">"Received signal"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">sigint_handler</span><span class="p">)</span> <span class="o">==</span> <span class="n">SIG_ERR</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"Cannot handle SIGINT!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(;;)</span>
        <span class="n">pause</span><span class="p">();</span> <span class="c1">// pause(2) : waiting a signal (any signal)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위 코드를 실행시킨 후 <code class="language-plaintext highlighter-rouge">ctrl + c</code> 를 누르면 아래의 메시지가 출력됨</p><p>실행 결과</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>^CCaught SIGINT!
Received signal: Interrupt
</pre></table></code></div></div><p>이 상태에서 종료하고 싶으면 <code class="language-plaintext highlighter-rouge">ctrl + z</code> (SIGTSTP)로 백그라운드로 이동해서 ps로 pid를 확인해서 <code class="language-plaintext highlighter-rouge">kill -9 &lt;pid&gt;</code> (9 : SIGKILL)로 종료시키면 됨</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">kill</span> <span class="nt">-9</span> 87116
<span class="o">[</span>1]  + 87116 killed     ./a.out
</pre></table></code></div></div><h2 id="handler-signal-상속-방법"><span class="mr-2">handler, signal 상속 방법</span><a href="#handler-signal-상속-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="on-fork"><span class="mr-2">On fork()</span><a href="#on-fork" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>시그널 처리 방식 상속받음<ul><li>signal handler, ignore, default</ul><li>pending 시그널은 상속 x<ul><li>해당 시그널은 부모에게 전달된 것임<li>pending signal : 아직 처리되지 않은 시그널</ul></ul><h3 id="on-exec"><span class="mr-2">On exec()</span><a href="#on-exec" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>signal handler 상속 x<ul><li>ignore, default는 상속받음</ul><li>pending signal 상속</ul><h1 id="시그널-전송">시그널 전송</h1><h2 id="관련-함수"><span class="mr-2">관련 함수</span><a href="#관련-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">int kill(pid_t pid, int signo)</code></p><p>프로세스에 시그널을 보냄</p><ul><li>매개변수<ul><li>pid : 시그널을 보낼 대상<ul><li>0 : 자신이 속한 프로세스 그룹 내 모든 프로세스<li>-1 : 현재 프로세스가 가진 권한으로 시그널을 보낼 수 잇는 모든 프로세스<li>-1보다 작은 값 : GID == pid 인 프로세스 그룹</ul><li>signo : 보낼 시그널 번호</ul><li>리턴값<ul><li>0 : Success<li>-1 : Fail<ul><li>errno = EINVAL : 유효하지 않은 signo<li>errno = EPERM : 시그널을 보낼 권한이 없음<li>errno = ESRCH : 대상 프로세스가 존재하지 않음 (또는 zombie process)<ul><li>zombie process : 프로세스가 종료되었는데 시스템상에 해당 정보가 남아있는 경우</ul></ul></ul></ul><h2 id="전송-권한"><span class="mr-2">전송 권한</span><a href="#전송-권한" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>다른 프로세스에게 시그널을 보내기 위해서는 적합한 권한이 필요함</p><h3 id="필요-권한"><span class="mr-2">필요 권한</span><a href="#필요-권한" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Sender’s RUID/EUID == Receiver’s RUID/SUID<li>root는 모든 프로세스에게 시그널 전달 가능</ul><h3 id="권한-체크"><span class="mr-2">권한 체크</span><a href="#권한-체크" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>null signal 활용 (실제 시그널을 전달하지 않으나 error checking을 수행함)</ul><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">kill</span><span class="p">(</span><span class="mi">1722</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
	<span class="c1">// 권한 없음</span>
<span class="k">else</span>
	<span class="c1">// 권한 있음</span>
</pre></table></code></div></div><h1 id="시그널-차단">시그널 차단</h1><h2 id="필요한-이유"><span class="mr-2">필요한 이유</span><a href="#필요한-이유" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>시그널은 임의의 순간 발생함 (중요 작업을 하는 중에 시그널이 들어올 수 있음)<li>위처럼 Critical region의 보호를 위해 시그널의 차단이 필요함</ul><h2 id="signal-set"><span class="mr-2">Signal set</span><a href="#signal-set" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>복수개의 시그널을 처리하기 위해 사용<li>sigset_t (=bit mask) : 각 비트가 시그널 번호와 1대 1 매핑</ul><p>예제 코드</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">// init</span>
<span class="kt">int</span> <span class="nf">sigemptyset</span><span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="n">set</span><span class="p">);</span> <span class="c1">// the set to empty</span>
<span class="kt">int</span> <span class="nf">sigfillset</span><span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="n">set</span><span class="p">);</span> <span class="c1">// the set to full</span>

<span class="c1">// add/delete signum to the set</span>
<span class="kt">int</span> <span class="nf">sigaddset</span><span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="n">set</span><span class="p">,</span> <span class="kt">int</span> <span class="n">signum</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">sigdelset</span><span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="n">set</span><span class="p">,</span> <span class="kt">int</span> <span class="n">signum</span><span class="p">);</span>

<span class="c1">// return 1 if signum is in the set</span>
<span class="kt">int</span> <span class="nf">sigismember</span><span class="p">(</span><span class="k">const</span> <span class="n">sigset_t</span> <span class="o">*</span><span class="n">set</span><span class="p">,</span> <span class="kt">int</span> <span class="n">signum</span><span class="p">);</span>
</pre></table></code></div></div><h2 id="관련-함수-1"><span class="mr-2">관련 함수</span><a href="#관련-함수-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">int sigprocmask (int how, const sigset_t *set, sigset_t *oldset);</code></p><p>시그널을 블록시킬지 말지를 결정함</p><ul><li>매개변수<ul><li>how : 지정방법<ul><li>SIG_SETMASK : set을 blocking mask로 적용<li>SIG_BLOCK : blocking 대상을 추가<li>SIG_UNBLOCK : blocking 대상에서 제거</ul><li>set : 적용할 signal set<ul><li>NULL : how를 무시(signal mask 유지), 현재 signal mask → oldset</ul><li>oldset : 적용 전 signal set을 반환</ul><li>리턴값<ul><li>0: 성공<li>-1 : 실패</ul><li>pending signal은 차단이 풀리면 전달됨</ul><p>예제 코드</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">handler_SIGINT</span><span class="p">(</span><span class="kt">int</span> <span class="n">_signo</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Received Signal : %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">strsignal</span><span class="p">(</span><span class="n">_signo</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">sigset_t</span> <span class="n">new</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">handler_SIGINT</span><span class="p">)</span> <span class="o">==</span> <span class="n">SIG_ERR</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">"signal SIGINT"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">new</span><span class="p">);</span>
    <span class="n">sigaddset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">new</span><span class="p">,</span> <span class="n">SIGINT</span><span class="p">);</span>
    <span class="n">sigaddset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">new</span><span class="p">,</span> <span class="n">SIGQUIT</span><span class="p">);</span>
    <span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_BLOCK</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">new</span><span class="p">,</span> <span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="p">)</span><span class="nb">NULL</span><span class="p">);</span>

    <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"UnBlocking Signals</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_UNBLOCK</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">new</span><span class="p">,</span> <span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="p">)</span><span class="nb">NULL</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위 코드를 실행한 후에 SIGINT를 주면 아래와 같이 5초간은 신호가 가지 않다가 5초 후에 신호를 받는 것을 알 수 있음.</p><p>실행 결과</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>^CUnBlocking Signals
Received Signal : Interrupt: 2
</pre></table></code></div></div><h1 id="시그널-대기">시그널 대기</h1><h2 id="관련-함수-2"><span class="mr-2">관련 함수</span><a href="#관련-함수-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">int sigsuspend(const sigset_t *mask);</code></p><p>Signal mask를 임시 교체 후, block 되지 않은 시그널이 도착할 때 까지 대기함</p><ul><li>매개변수<ul><li>mask : 교체할 signal set의 주소</ul><li>반환값<ul><li>항상 -1<li>errno = EINTR → signal에 의해 interrupt 발생</ul></ul><p>예제 코드</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">psignal</span><span class="p">(</span><span class="n">signo</span><span class="p">,</span> <span class="s">"Received Signal:"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sigset_t</span> <span class="n">set</span><span class="p">;</span>

    <span class="n">signal</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span> <span class="n">handler</span><span class="p">);</span>

    <span class="n">sigfillset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">set</span><span class="p">);</span>
    <span class="n">sigdelset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">set</span><span class="p">,</span> <span class="n">SIGALRM</span><span class="p">);</span>

    <span class="n">alarm</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"Wait...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

    <span class="n">sigsuspend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">set</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>실행 결과</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Wait...
Received Signal:: Alarm clock
</pre></table></code></div></div><h1 id="ref">Ref.</h1><p><a href="https://www.youtube.com/watch?v=ezVbjE29Lpg">https://www.youtube.com/watch?v=ezVbjE29Lpg</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/42seoul/'>42Seoul</a>, <a href='/categories/minitalk/'>Minitalk</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/42seoul/" class="post-tag no-text-decoration" >42seoul</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Minitalk+%E2%91%A1+%EB%B0%B0%EA%B2%BD+%EC%A7%80%EC%8B%9D+%3A+%EC%8B%9C%EA%B7%B8%EB%84%90+-+Justnote&url=https%3A%2F%2F23tae.github.io%2Fposts%2Fminitalk2%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Minitalk+%E2%91%A1+%EB%B0%B0%EA%B2%BD+%EC%A7%80%EC%8B%9D+%3A+%EC%8B%9C%EA%B7%B8%EB%84%90+-+Justnote&u=https%3A%2F%2F23tae.github.io%2Fposts%2Fminitalk2%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F23tae.github.io%2Fposts%2Fminitalk2%2F&text=Minitalk+%E2%91%A1+%EB%B0%B0%EA%B2%BD+%EC%A7%80%EC%8B%9D+%3A+%EC%8B%9C%EA%B7%B8%EB%84%90+-+Justnote" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/os02/">[운영 체제] 02. Operating-System Structures</a><li><a href="/posts/os03/">[운영 체제] 03. Processes</a><li><a href="/posts/os04/">[운영 체제] 04. Thread & Concurrency</a><li><a href="/posts/minitalk3/">Minitalk ③ 배경 지식 : 기타</a><li><a href="/posts/push_swap1/">Push_swap ① Subject</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/42seoul/">42seoul</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/dp/">dp</a> <a class="post-tag" href="/tags/issue/">issue</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/vscode/">vscode</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/minitalk3/"><div class="card-body"> <em class="small" data-ts="1657638000" data-df="ll" > Jul 13, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Minitalk ③ 배경 지식 : 기타</h3><div class="text-muted small"><p> 데이터 통신 두개의 직접 연결된 디바이스가 데이터를 교환하는 것 채널 개수로 구분 데이터는 비트의 형태로 디바이스 사이를 이동함 직렬 통신 (Serial Transmission) 병렬 통신 (Parallel Transmission) 직렬 통신 (Serial Transmission) 한개의 채널을 사용해 한 비트씩 순서대로 이동시키...</p></div></div></a></div><div class="card"> <a href="/posts/minitalk4/"><div class="card-body"> <em class="small" data-ts="1658070000" data-df="ll" > Jul 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Minitalk ④ 프로젝트 구현</h3><div class="text-muted small"><p> 구현한 기능 server server pid 출력 시그널 수신 메시지 출력 발송인의 pid 출력 받은 바이트 출력 메시지 수신 여부 출력 client client pid 출력 연결 여부 출력 시그널 전송 보낸 바이트 출력 메시지 전송 성공 여부 출력 방법 구상 server on clien...</p></div></div></a></div><div class="card"> <a href="/posts/minitalk1/"><div class="card-body"> <em class="small" data-ts="1656946800" data-df="ll" > Jul 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Minitalk ① Subject</h3><div class="text-muted small"><p> Pdf Summary 이번 프로젝트에서는 유닉스 시그널을 통해 소규모의 데이터를 교환하는 프로그램을 구현합니다. Mandatory Part 클라이언트와 서버의 형태로 통신 프로그램을 만들어야 합니다. 서버가 먼저 시작돼고 그 후에 해당 PID를 나타내야 합니다. 클라이언트는 다음과 같은 매개 변수를 사용합니다. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/function_pointer/" class="btn btn-outline-primary" prompt="Older"><p>함수 포인터</p></a> <a href="/posts/minitalk3/" class="btn btn-outline-primary" prompt="Newer"><p>Minitalk ③ 배경 지식 : 기타</p></a></div><script src="https://utteranc.es/client.js" repo="23tae/comments" issue-term="pathname" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/23tae">Taehoon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/42seoul/">42seoul</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/dp/">dp</a> <a class="post-tag" href="/tags/issue/">issue</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/vscode/">vscode</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
